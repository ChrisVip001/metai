# MetaI (Meta Intelligence)

<div align="center">

**åŸºäº Rust + Burn çš„é«˜æ€§èƒ½å¤§è¯­è¨€æ¨¡å‹è®­ç»ƒä¸æ¨ç†æ¡†æ¶**

[![Rust](https://img.shields.io/badge/rust-1.70+-orange.svg)](https://www.rust-lang.org/)
[![Burn](https://img.shields.io/badge/burn-0.19.1-blue.svg)](https://github.com/tracel-ai/burn)
[![License](https://img.shields.io/badge/license-MIT-green.svg)](LICENSE)

</div>

---

MetaI æ˜¯ä¸€ä¸ªåŸºäº [Burn](https://github.com/tracel-ai/burn) æ·±åº¦å­¦ä¹ æ¡†æ¶æ„å»ºçš„é«˜æ€§èƒ½å¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰è®­ç»ƒä¸æ¨ç†ç³»ç»Ÿã€‚é¡¹ç›®é‡‡ç”¨ Rust è¯­è¨€å®ç°ï¼Œå……åˆ†åˆ©ç”¨ç°ä»£ GPU åŠ é€Ÿï¼ˆWGPU/Metal/Vulkanï¼‰ï¼Œæ—¨åœ¨ä½¿ç”¨ Rust å’Œ Burn å®ç°å®Œæ•´çš„ LLM è®­ç»ƒå’Œæ¨ç†æµç¨‹ã€‚

## âœ¨ æ ¸å¿ƒç‰¹æ€§

### ğŸš€ æ€§èƒ½ä¼˜åŒ–
- **Rust + Burn 0.19.1**: åŸºäº Rust çš„é«˜æ€§èƒ½æ·±åº¦å­¦ä¹ æ¡†æ¶ï¼Œæ”¯æŒ WGPU (Metal/Vulkan) ç¡¬ä»¶åŠ é€Ÿ
- **KV Cache æ¨ç†**: å®ç° $O(N)$ å¤æ‚åº¦çš„å¢é‡æ¨ç†ï¼Œé•¿æ–‡æœ¬ç”Ÿæˆé€Ÿåº¦æå‡ 100x
- **æ¢¯åº¦ç´¯ç§¯**: æ”¯æŒæ¢¯åº¦ç´¯ç§¯ (Gradient Accumulation)ï¼Œåœ¨ 16GB å†…å­˜ä¸Šæ¨¡æ‹Ÿå¤§ Batch Size è®­ç»ƒ
- **æ··åˆç²¾åº¦è®­ç»ƒ**: ä¼˜åŒ–å†…å­˜ä½¿ç”¨ï¼Œæ”¯æŒæ›´å¤§æ¨¡å‹è®­ç»ƒ

### ğŸ§  å…ˆè¿›æ¶æ„
- **Mixture of Experts (MoE)**: æ”¯æŒ **Sparse Execution (ç¨€ç–æ‰§è¡Œ)** çš„ MoE æ¶æ„ã€‚åˆ©ç”¨ Gather-Compute-Scatter æ¨¡å¼ï¼Œä»…è®¡ç®—è·¯ç”±é€‰ä¸­çš„ä¸“å®¶ï¼Œæ¨ç†è®¡ç®—é‡ä¸å†éšä¸“å®¶æ•°é‡å¢åŠ è€Œå¢åŠ ã€‚
- **SFT æŒ‡ä»¤å¾®è°ƒ**: åŸç”Ÿæ”¯æŒ Supervised Fine-Tuningï¼Œæ”¯æŒ JSONL æ ¼å¼æŒ‡ä»¤æ•°æ®ï¼Œå®ç°äº† Loss Masking ä»¥å±è”½ç”¨æˆ·æŒ‡ä»¤éƒ¨åˆ†çš„ Lossã€‚
- **Llama 3 é£æ ¼**: é›†æˆ Grouped Query Attention (GQA)ã€RoPE æ—‹è½¬ä½ç½®ç¼–ç ã€RMSNorm å’Œ SwiGLU æ¿€æ´»å‡½æ•°
- **å…¨é“¾è·¯ Padding Mask**: å®ç° Loss Masking å’Œ Attention Maskingï¼Œå®Œç¾è§£å†³å˜é•¿åºåˆ—è®­ç»ƒé—®é¢˜

### ğŸ›  å·¥ç¨‹åŒ–ç‰¹æ€§
- **æ–­ç‚¹ç»­è®­**: è‡ªåŠ¨ä¿å­˜ä¸åŠ è½½ Checkpointï¼Œè®­ç»ƒéšæ—¶ä¸­æ–­ï¼Œéšæ—¶ç»§ç»­
- **INT4 é‡åŒ–**: æ”¯æŒ 4-bit æƒé‡é‡åŒ–ï¼ˆBlock-wiseï¼‰ï¼Œå¤§å¹…é™ä½éƒ¨ç½²æ˜¾å­˜éœ€æ±‚ï¼ˆçº¦ 4 å€å‹ç¼©ï¼‰
- **Lazy Data Loading**: å®ç°åŸºäºç£ç›˜ç´¢å¼•çš„ `LazyTextDataset`ï¼Œæ”¯æŒ TB çº§è¶…å¤§æ•°æ®é›†çš„æµå¼è®­ç»ƒ
- **å¤šè¯­è¨€æ”¯æŒ**: å†…ç½®æ•°æ®å¤„ç†è„šæœ¬ï¼Œæ”¯æŒä¸­è‹±æ–‡æ··åˆè®­ç»ƒ

## ğŸ“‹ ç›®å½•

- [å¿«é€Ÿå¼€å§‹](#-å¿«é€Ÿå¼€å§‹)
- [å®‰è£…è¦æ±‚](#-å®‰è£…è¦æ±‚)
- [ä½¿ç”¨æŒ‡å—](#-ä½¿ç”¨æŒ‡å—)
- [å‘½ä»¤å‚è€ƒ](#-å‘½ä»¤å‚è€ƒ)
- [æ¨¡å‹é…ç½®](#-æ¨¡å‹é…ç½®)
- [é¡¹ç›®æ¶æ„](#-é¡¹ç›®æ¶æ„)
- [å¸¸è§é—®é¢˜](#-å¸¸è§é—®é¢˜)
- [è´¡çŒ®æŒ‡å—](#-è´¡çŒ®æŒ‡å—)

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å®‰è£…è¦æ±‚

- **Rust**: 1.70+ ([å®‰è£…æŒ‡å—](https://www.rust-lang.org/tools/install))
- **Python**: 3.8+ (ç”¨äºæ•°æ®å‡†å¤‡è„šæœ¬)
- **GPU**: æ”¯æŒ Metal (macOS) æˆ– Vulkan (Linux/Windows) çš„æ˜¾å¡
- **å†…å­˜**: æ¨è 16GB+ (Tiny æ¨¡å‹éœ€è¦ <1GB)

### å®‰è£…æ­¥éª¤

```bash
# 1. å…‹éš†é¡¹ç›®
git clone https://github.com/ChrisVip001/metai.git
cd metai

# 2. ç¼–è¯‘é¡¹ç›®ï¼ˆé¦–æ¬¡ç¼–è¯‘å¯èƒ½éœ€è¦ 10-20 åˆ†é’Ÿï¼‰
cargo build --release

# 3. å‡†å¤‡æ•°æ®ï¼ˆå¯é€‰ï¼Œç”¨äºè®­ç»ƒï¼‰
pip install datasets tqdm
python3 scripts/prepare_local_data.py
```

## ğŸ“– ä½¿ç”¨æŒ‡å—

### 1. è®­ç»ƒæ¨¡å‹

#### Tiny æ¨¡å‹ï¼ˆå¿«é€Ÿæµ‹è¯•ï¼Œ1M å‚æ•°ï¼‰

é€‚åˆå¿«é€ŸåŠŸèƒ½éªŒè¯å’Œ CI æµ‹è¯•ï¼š

```bash
cargo run --release -- train-tiny \
    --chinese-path 4in1.txt \
    --english-path dataset.txt
```


**è®­ç»ƒè¯´æ˜ï¼š**
- è®­ç»ƒè¿‡ç¨‹ä¼šè‡ªåŠ¨æ‰“å¼€ Burn çš„ TUI ç›‘æ§ç•Œé¢
- æŒ‰ `Ctrl+C` å¯æš‚åœå¹¶ä¿å­˜æ£€æŸ¥ç‚¹
- å†æ¬¡è¿è¡Œç›¸åŒå‘½ä»¤ä¼šè‡ªåŠ¨ä»æœ€æ–°æ£€æŸ¥ç‚¹æ¢å¤è®­ç»ƒ
- æ£€æŸ¥ç‚¹ä¿å­˜åœ¨ `/tmp/metai_tiny` æˆ– `/tmp/metai_local`

### 2. æ–‡æœ¬ç”Ÿæˆ

ä½¿ç”¨è®­ç»ƒå¥½çš„æ¨¡å‹è¿›è¡Œæ–‡æœ¬ç”Ÿæˆï¼š

```bash
# åŸºç¡€ç”¨æ³•
cargo run --release -- generate \
    --prompt "äººå·¥æ™ºèƒ½çš„æœªæ¥æ˜¯"

# å®Œæ•´å‚æ•°ç¤ºä¾‹
cargo run --release -- generate \
    --prompt "è¯·è§£é‡Šä¸€ä¸‹æ·±åº¦å­¦ä¹ çš„åŸºæœ¬åŸç†" \
    --model-dir /tmp/metai_local \
    --max-len 200 \
    --temperature 0.7 \
    --top-k 50 \
    --top-p 0.95
```

### 3. æ¨¡å‹é‡åŒ–

å°†è®­ç»ƒå¥½çš„æ¨¡å‹å‹ç¼©ä¸º INT4 æ ¼å¼ï¼š

```bash
cargo run --release -- quantize \
    --input-path /tmp/metai_local \
    --output-path /tmp/metai_quantized
```

é‡åŒ–åçš„æ¨¡å‹å¯ä»¥æ˜¾è‘—å‡å°‘å†…å­˜å ç”¨ï¼ˆçº¦ 4 å€å‹ç¼©ï¼‰ï¼Œé€‚åˆéƒ¨ç½²åˆ°èµ„æºå—é™çš„ç¯å¢ƒã€‚

### 6. DPO å¯¹é½ (Direct Preference Optimization)

åœ¨ SFT ä¹‹åï¼Œä½¿ç”¨ DPO æ ¹æ®äººç±»åå¥½è¿›ä¸€æ­¥å¯¹é½æ¨¡å‹ï¼š

```bash
# å‡è®¾å·²ç»å®Œæˆ SFTï¼Œæ¨¡å‹ä¿å­˜åœ¨ output-sft/checkpoint/model-10.bin
cargo run --release -- train-dpo \
    --data data/dpo_data.jsonl \
    --model-dir output-sft \
    --output-dir output-dpo
```

æ•°æ®æ ¼å¼ (JSONL):
```json
{"instruction": "What is AI?", "chosen": "AI is Artificial Intelligence...", "rejected": "AI is a robot that kills humans."}
```

## ğŸ“š å‘½ä»¤å‚è€ƒ

### è®­ç»ƒå‘½ä»¤

#### `train-tiny`

è¿è¡Œ 1M å‚æ•°çš„å°æ¨¡å‹è®­ç»ƒï¼Œç”¨äºå¿«é€ŸåŠŸèƒ½éªŒè¯ã€‚

**å‚æ•°ï¼š**
- `-c, --chinese-path <PATH>`: ä¸­æ–‡æ•°æ®æ–‡ä»¶è·¯å¾„ï¼ˆé»˜è®¤: `4in1.txt`ï¼‰
- `-e, --english-path <PATH>`: è‹±æ–‡æ•°æ®æ–‡ä»¶è·¯å¾„ï¼ˆé»˜è®¤: `dataset.txt`ï¼‰
- `-t, --tokenizer-path <PATH>`: åˆ†è¯å™¨æ–‡ä»¶è·¯å¾„ï¼ˆé»˜è®¤: `tokenizer.json`ï¼‰

**ç¤ºä¾‹ï¼š**
```bash
cargo run --release -- train-tiny \
    -c data/chinese.txt \
    -e data/english.txt \
    -t tokenizer.json
```


### æ¨ç†å‘½ä»¤

#### `generate`

ä½¿ç”¨è®­ç»ƒå¥½çš„æ¨¡å‹ç”Ÿæˆæ–‡æœ¬ï¼Œæ”¯æŒå¤šç§é‡‡æ ·ç­–ç•¥ã€‚

**å‚æ•°ï¼š**
- `-p, --prompt <TEXT>`: **å¿…éœ€**ï¼Œè¾“å…¥æç¤ºæ–‡æœ¬
- `-m, --model-dir <PATH>`: æ¨¡å‹æ£€æŸ¥ç‚¹ç›®å½•ï¼ˆé»˜è®¤: `/tmp/metai_local`ï¼‰
- `-l, --max-len <NUM>`: æœ€å¤§ç”Ÿæˆ token æ•°ï¼ˆé»˜è®¤: `50`ï¼‰
- `-T, --temperature <FLOAT>`: é‡‡æ ·æ¸©åº¦ï¼ˆé»˜è®¤: `0.8`ï¼‰
  - `0.0`: è´ªå©ªé‡‡æ ·ï¼ˆç¡®å®šæ€§è¾“å‡ºï¼‰
  - `0.5-1.0`: å¹³è¡¡åˆ›é€ æ€§å’Œå‡†ç¡®æ€§
  - `>1.0`: æ›´éšæœºï¼Œæ›´æœ‰åˆ›é€ æ€§
- `-k, --top-k <NUM>`: Top-K é‡‡æ ·ï¼Œé™åˆ¶å€™é€‰ token æ•°é‡ï¼ˆé»˜è®¤: `40`ï¼‰
- `-P, --top-p <FLOAT>`: Top-P (Nucleus) é‡‡æ ·ï¼Œç´¯ç§¯æ¦‚ç‡é˜ˆå€¼ï¼ˆé»˜è®¤: `0.9`ï¼‰
- `-t, --tokenizer-path <PATH>`: åˆ†è¯å™¨æ–‡ä»¶è·¯å¾„ï¼ˆé»˜è®¤: `tokenizer.json`ï¼‰

**ç¤ºä¾‹ï¼š**
```bash
# åŸºç¡€ç”Ÿæˆ
cargo run --release -- generate -p "äººå·¥æ™ºèƒ½çš„æœªæ¥æ˜¯"

# å®Œæ•´å‚æ•°
cargo run --release -- generate \
    -p "The future of AI is" \
    -m /tmp/metai_local \
    -l 200 \
    -T 0.7 \
    -k 50 \
    -P 0.95

# è´ªå©ªé‡‡æ ·ï¼ˆç¡®å®šæ€§è¾“å‡ºï¼‰
cargo run --release -- generate \
    -p "æ·±åº¦å­¦ä¹ æ˜¯" \
    -T 0.0
```

**é‡‡æ ·ç­–ç•¥è¯´æ˜ï¼š**

| å‚æ•° | ä½œç”¨ | æ¨èå€¼ |
|:---|:---|:---|
| `temperature` | æ§åˆ¶è¾“å‡ºéšæœºæ€§ | 0.7-0.9ï¼ˆåˆ›æ„æ–‡æœ¬ï¼‰ï¼Œ0.0ï¼ˆç¡®å®šæ€§ï¼‰ |
| `top-k` | é™åˆ¶å€™é€‰ token æ•°é‡ | 40-50ï¼ˆå¹³è¡¡ï¼‰ï¼Œ10-20ï¼ˆä¿å®ˆï¼‰ |
| `top-p` | åŠ¨æ€é€‰æ‹©å€™é€‰ token | 0.9-0.95ï¼ˆæ¨èï¼‰ |

### é‡åŒ–å‘½ä»¤

#### `quantize`

å°†è®­ç»ƒå¥½çš„æ¨¡å‹å‹ç¼©ä¸º INT4 æ ¼å¼ï¼Œå¤§å¹…å‡å°‘æ¨¡å‹å¤§å°å’Œæ¨ç†æ—¶çš„å†…å­˜å ç”¨ã€‚

**å‚æ•°ï¼š**
- `-i, --input-path <PATH>`: **å¿…éœ€**ï¼Œè¾“å…¥æ¨¡å‹æ£€æŸ¥ç‚¹ç›®å½•
- `-o, --output-path <PATH>`: **å¿…éœ€**ï¼Œé‡åŒ–åæ¨¡å‹ä¿å­˜ç›®å½•
- `-t, --tokenizer-path <PATH>`: åˆ†è¯å™¨æ–‡ä»¶è·¯å¾„ï¼ˆé»˜è®¤: `tokenizer.json`ï¼‰

**ç¤ºä¾‹ï¼š**
```bash
cargo run --release -- quantize \
    -i /tmp/metai_local \
    -o /tmp/metai_quantized \
    -t tokenizer.json
```

**è¯´æ˜ï¼š**
- é‡åŒ–åçš„æ¨¡å‹ä¿å­˜åœ¨ `{output_path}/checkpoint/model-{epoch}-quantized.bin`
- é‡åŒ–ä¼šç•¥å¾®é™ä½æ¨¡å‹ç²¾åº¦ï¼ˆé€šå¸¸ <5%ï¼‰ï¼Œä½†å¯ä»¥æ˜¾è‘—å‡å°‘å†…å­˜å ç”¨
- é‡åŒ–åçš„æ¨¡å‹å¯ä»¥ç›´æ¥ç”¨äºæ¨ç†ï¼Œæ— éœ€é¢å¤–å¤„ç†

## ğŸ§ª æ¨¡å‹é…ç½®

é¡¹ç›®æä¾›äº†å¤šç§é¢„å®šä¹‰çš„æ¨¡å‹é…ç½®ï¼Œé€‚ç”¨äºä¸åŒçš„ç¡¬ä»¶å’Œåœºæ™¯ï¼š

| é…ç½®å | å‚æ•°é‡ | æ¶æ„ | æ˜¾å­˜éœ€æ±‚ (è®­ç»ƒ) | æ˜¾å­˜éœ€æ±‚ (æ¨ç†) | é€‚ç”¨åœºæ™¯ |
|:---|:---|:---|:---|:---|:---|
| **Tiny** | 1M | Dense | < 1GB | < 500MB | å¿«é€ŸåŠŸèƒ½éªŒè¯ / CI |
| **Small** | 125M | MoE (8E, Top2) | ~4GB | ~2GB | ç®—æ³•ç ”ç©¶ / æ—©æœŸéªŒè¯ |
| **Local** | ~200M | MoE (Optimized) | ~12GB | ~4GB | **16GB å†…å­˜è®¾å¤‡æ¨è** |
| **Llama3** | 8B | Dense (GQA) | > 24GB | > 8GB | ç”Ÿäº§çº§é¢„è®­ç»ƒ |


## ğŸ—ï¸ é¡¹ç›®æ¶æ„

### ç›®å½•ç»“æ„

```
metai/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ model/              # æ¨¡å‹æ ¸å¿ƒå®šä¹‰
â”‚   â”‚   â”œâ”€â”€ attention.rs    # Grouped Query Attention (GQA)
â”‚   â”‚   â”œâ”€â”€ mlp.rs          # Mixture of Experts (MoE) + SwiGLU
â”‚   â”‚   â”œâ”€â”€ norm.rs         # RMSNorm å½’ä¸€åŒ–
â”‚   â”‚   â”œâ”€â”€ positional_encoding.rs  # RoPE æ—‹è½¬ä½ç½®ç¼–ç 
â”‚   â”‚   â”œâ”€â”€ config.rs        # æ¨¡å‹é…ç½®å®šä¹‰
â”‚   â”‚   â””â”€â”€ mod.rs          # ä¸»æ¨¡å‹ç»“æ„ (MetaIModel)
â”‚   â”œâ”€â”€ train/              # è®­ç»ƒç›¸å…³
â”‚   â”‚   â”œâ”€â”€ train.rs        # è®­ç»ƒä¸»é€»è¾‘
â”‚   â”‚   â””â”€â”€ mod.rs          # è®­ç»ƒé…ç½®å’Œæ­¥éª¤å®ç°
â”‚   â”œâ”€â”€ infer/              # æ¨ç†å¼•æ“
â”‚   â”‚   â”œâ”€â”€ cache.rs        # KV Cache å®ç°
â”‚   â”‚   â””â”€â”€ mod.rs          # æ–‡æœ¬ç”Ÿæˆå™¨ (Generator)
â”‚   â”œâ”€â”€ data/               # æ•°æ®å¤„ç†
â”‚   â”‚   â”œâ”€â”€ data.rs         # æ•°æ®é›†å’Œæ‰¹å¤„ç†å™¨
â”‚   â”‚   â””â”€â”€ mod.rs          # åˆ†è¯å™¨ (MetaITokenizer)
â”‚   â”œâ”€â”€ lib.rs              # åº“å…¥å£ï¼Œå¯¼å‡ºå…¬å…± API
â”‚   â””â”€â”€ main.rs             # CLI å…¥å£
â”œâ”€â”€ scripts/                # æ•°æ®å¤„ç†è„šæœ¬
â”‚   â””â”€â”€ prepare_local_data.py  # æ•°æ®å‡†å¤‡è„šæœ¬
â”œâ”€â”€ tests/                  # å•å…ƒæµ‹è¯•
â”œâ”€â”€ Cargo.toml             # é¡¹ç›®é…ç½®
â””â”€â”€ README.md              # æœ¬æ–‡æ¡£
```

### æ ¸å¿ƒç»„ä»¶

#### 1. æ¨¡å‹æ¶æ„ (`src/model/`)

- **MetaIModel**: ä¸»æ¨¡å‹ç»“æ„ï¼ŒåŒ…å« Embeddingã€Transformer Blocksã€è¾“å‡ºå±‚
- **TransformerBlock**: Transformer å—ï¼ŒåŒ…å« Attention å’Œ MoE MLP
- **GroupedQueryAttention**: GQA æ³¨æ„åŠ›æœºåˆ¶ï¼Œå‡å°‘ KV ç¼“å­˜å¤§å°
- **MoE**: Mixture of Expertsï¼Œæ”¯æŒç¨€ç–æ¿€æ´»
- **RoPE**: æ—‹è½¬ä½ç½®ç¼–ç ï¼Œæå‡é•¿åºåˆ—å»ºæ¨¡èƒ½åŠ›
- **RMSNorm**: Root Mean Square å½’ä¸€åŒ–

#### 2. è®­ç»ƒç³»ç»Ÿ (`src/train/`)

- **è®­ç»ƒå¾ªç¯**: åŸºäº Burn çš„ Learner API
- **æ–­ç‚¹ç»­è®­**: è‡ªåŠ¨ä¿å­˜å’ŒåŠ è½½æ£€æŸ¥ç‚¹
- **æ¢¯åº¦ç´¯ç§¯**: æ”¯æŒå¤§ Batch Size è®­ç»ƒ
- **æŸå¤±è®¡ç®—**: æ”¯æŒ Padding Mask çš„äº¤å‰ç†µæŸå¤±

#### 3. æ¨ç†å¼•æ“ (`src/infer/`)

- **Generator**: æ–‡æœ¬ç”Ÿæˆå™¨ï¼Œæ”¯æŒå¤šç§é‡‡æ ·ç­–ç•¥
- **KV Cache**: å¢é‡æ¨ç†ç¼“å­˜ï¼Œæå‡ç”Ÿæˆé€Ÿåº¦
- **é‡‡æ ·ç­–ç•¥**: æ”¯æŒ Temperatureã€Top-Kã€Top-P é‡‡æ ·

#### 4. æ•°æ®å¤„ç† (`src/data/`)

- **MetaITokenizer**: åŸºäº HuggingFace Tokenizers çš„åˆ†è¯å™¨
- **TextDataset**: å†…å­˜æ•°æ®é›†ï¼Œé€‚åˆå°è§„æ¨¡æ•°æ®
- **LazyTextDataset**: æƒ°æ€§æ•°æ®é›†ï¼Œæ”¯æŒ TB çº§æ•°æ®
- **TextBatcher**: æ‰¹å¤„ç†å™¨ï¼Œè‡ªåŠ¨å¤„ç†å˜é•¿åºåˆ—

## â“ å¸¸è§é—®é¢˜

### Q: è®­ç»ƒæ—¶å‡ºç°å†…å­˜ä¸è¶³é”™è¯¯ï¼Ÿ

**A:** å°è¯•ä»¥ä¸‹æ–¹æ³•ï¼š
1. ä½¿ç”¨ `train-tiny` è¿›è¡Œå¿«é€Ÿæµ‹è¯•
2. å‡å° `batch_size`ï¼ˆåœ¨ `src/train/train.rs` ä¸­ä¿®æ”¹ï¼‰
3. å¢åŠ  `grads_accumulation` ä»¥ä¿æŒæœ‰æ•ˆ batch size
4. ä½¿ç”¨é‡åŒ–åçš„æ¨¡å‹è¿›è¡Œæ¨ç†

### Q: å¦‚ä½•æé«˜ç”Ÿæˆè´¨é‡ï¼Ÿ

**A:** 
1. å¢åŠ è®­ç»ƒæ•°æ®é‡å’Œè®­ç»ƒè½®æ•°
2. ä½¿ç”¨æ›´å¤§çš„æ¨¡å‹é…ç½®ï¼ˆå¦‚ `Local` æˆ– `Small`ï¼‰
3. è°ƒæ•´é‡‡æ ·å‚æ•°ï¼š`temperature=0.7`, `top-k=50`, `top-p=0.95`
4. ä½¿ç”¨æ›´é•¿çš„ä¸Šä¸‹æ–‡é•¿åº¦ï¼ˆåœ¨é…ç½®ä¸­ä¿®æ”¹ `max_seq_len`ï¼‰

### Q: é‡åŒ–åæ¨¡å‹ç²¾åº¦ä¸‹é™æ˜æ˜¾ï¼Ÿ

**A:**
1. é‡åŒ–æ˜¯åè®­ç»ƒé‡åŒ–ï¼ˆPTQï¼‰ï¼Œç²¾åº¦æŸå¤±æ˜¯æ­£å¸¸çš„
2. å¯ä»¥å°è¯•é‡åŒ–æ„ŸçŸ¥è®­ç»ƒï¼ˆQATï¼‰æ¥å‡å°‘ç²¾åº¦æŸå¤±
3. å¯¹äºå…³é”®åº”ç”¨ï¼Œå»ºè®®ä½¿ç”¨ FP16 æˆ– FP32 ç²¾åº¦


### Q: å¦‚ä½•æ·»åŠ è‡ªå®šä¹‰æ•°æ®é›†ï¼Ÿ

**A:**
1. å‡†å¤‡æ•°æ®æ–‡ä»¶ï¼ˆæ¯è¡Œä¸€ä¸ªæ ·æœ¬ï¼‰
2. ä½¿ç”¨ `MetaITokenizer::train()` è®­ç»ƒåˆ†è¯å™¨
3. åœ¨è®­ç»ƒå‘½ä»¤ä¸­æŒ‡å®šæ•°æ®è·¯å¾„

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿è´¡çŒ®ä»£ç ï¼è¯·éµå¾ªä»¥ä¸‹æ­¥éª¤ï¼š

1. Fork æœ¬ä»“åº“
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. å¼€å¯ Pull Request

### å¼€å‘æŒ‡å—

- ä»£ç é£æ ¼ï¼šéµå¾ª Rust å®˜æ–¹é£æ ¼æŒ‡å—
- æµ‹è¯•ï¼šæ·»åŠ æ–°åŠŸèƒ½æ—¶è¯·æ·»åŠ ç›¸åº”çš„æµ‹è¯•
- æ–‡æ¡£ï¼šæ›´æ–°ç›¸å…³æ–‡æ¡£å’Œæ³¨é‡Š

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ã€‚è¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶ã€‚

## ğŸ™ è‡´è°¢

- [Burn](https://github.com/tracel-ai/burn) - ä¼˜ç§€çš„ Rust æ·±åº¦å­¦ä¹ æ¡†æ¶
- [HuggingFace Tokenizers](https://github.com/huggingface/tokenizers) - é«˜æ€§èƒ½åˆ†è¯å™¨
- æ‰€æœ‰è´¡çŒ®è€…å’Œç”¨æˆ·çš„æ”¯æŒ

## ğŸ“® è”ç³»æ–¹å¼

- **Issues**: [GitHub Issues](https://github.com/your-username/metai/issues)
- **Discussions**: [GitHub Discussions](https://github.com/your-username/metai/discussions)

---

<div align="center">

**å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·ç»™ä¸€ä¸ª â­ Starï¼**

Made with â¤ï¸ by the MetaI team

</div>
